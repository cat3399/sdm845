# SPDX-License-Identifier: (GPL-2.0-only OR BSD-2-Clause)
%YAML 1.2
---
$id: "http://devicetree.org/schemas/usb/qcom,pmic-pdphy.yaml#"
$schema: "http://devicetree.org/meta-schemas/core.yaml#"

title: Qualcomm PMIC based USB PDPHY driver

maintainers:
  - Bryan O'Donoghue <bryan.odonoghue@linaro.org>

description: |
  Qualcomm PMIC Power Delivery PHY driver

properties:
  compatible:
    enum:
      - qcom,pm8150b-pdphy

  reg:
    maxItems: 1
    description: PDPHY base address

  interrupts:
    items:
      - description: Sig TX - transmitted reset signal
      - description: Sig RX - received reset signal
      - description: TX completion
      - description: RX completion
      - description: TX fail
      - description: TX discgard
      - description: RX discgard
      - description: Fast Role Swap event

  interrupt-names:
    items:
       - const: pmic-pdphy-sig-tx
       - const: pmic-pdphy-sig-rx
       - const: pmic-pdphy-msg-tx
       - const: pmic-pdphy-msg-rx
       - const: pmic-pdphy-msg-tx-failed
       - const: pmic-pdphy-msg-tx-discarded
       - const: pmic-pdphy-msg-rx-discarded
       - const: pmic-pdphy-fr-swap

  ports:
    description: Remote endpoint connections
    type: object
    $ref: /connector/usb-connector.yaml#/properties/ports

        properties:
          port@0:
            description: Remote endpoints for the TCPM driver
            type: object

required:
  - compatible
  - reg
  - interrupts
  - interrupt-names
  - ports

additionalProperties: false

examples:
  - |
    #include <dt-bindings/interrupt-controller/irq.h>
    #include <dt-bindings/usb/typec/tcpm/qcom,pmic-usb-pdphy.h>

    pm8150b {
        #address-cells = <1>;
        #size-cells = <0>;

        pm8150b_pdphy: pdphy@1700 {
            compatible = "qcom,pm8150b-pdphy";
            reg = <0x1700>;
            interrupts = <0x2 0x17 PMIC_PDPHY_SIG_TX_IRQ
                          IRQ_TYPE_EDGE_RISING>,
                         <0x2 0x17 PMIC_PDPHY_SIG_RX_IRQ
                          IRQ_TYPE_EDGE_RISING>,
                         <0x2 0x17 PMIC_PDPHY_MSG_TX_IRQ
                          IRQ_TYPE_EDGE_RISING>,
                         <0x2 0x17 PMIC_PDPHY_MSG_RX_IRQ
                          IRQ_TYPE_EDGE_RISING>,
                         <0x2 0x17 PMIC_PDPHY_MSG_TX_FAIL_IRQ
                          IRQ_TYPE_EDGE_RISING>,
                         <0x2 0x17 PMIC_PDPHY_MSG_TX_DISCARD_IRQ
                          IRQ_TYPE_EDGE_RISING>,
                         <0x2 0x17 PMIC_PDPHY_MSG_RX_DISCARD_IRQ
                          IRQ_TYPE_EDGE_RISING>,
                         <0x2 0x17 PMIC_PDPHY_FR_SWAP_IRQ
                          IRQ_TYPE_EDGE_RISING>;
            interrupt-names = "pmic-pdphy-sig-tx",
                              "pmic-pdphy-sig-rx",
                              "pmic-pdphy-msg-tx",
                              "pmic-pdphy-msg-rx",
                              "pmic-pdphy-msg-tx-failed",
                              "pmic-pdphy-msg-tx-discarded",
                              "pmic-pdphy-msg-rx-discarded",
                              "pmic-pdphy-fr-swap";
            ports {
                #address-cells = <1>;
                #size-cells = <0>;

                port@0 {
                    reg = <0>;
                    pmic_pdphy: endpoint {
                        remote-endpoint = <&pmic_tcpm_pdphy>;
                    };
                };
            };
        };
    };
...
